============================= test session starts ==============================
platform linux -- Python 3.13.5, pytest-8.3.5, pluggy-1.6.0
rootdir: /home/juan/Documents/projects/software/ista-calista
configfile: pyproject.toml
testpaths: tests
plugins: anyio-4.9.0, asyncio-0.26.0, cov-6.1.1, homeassistant-custom-component-0.13.263, socket-0.7.0, requests-mock-1.12.1, respx-0.22.0, syrupy-4.9.1
asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 32 items

tests/test_config_flow.py F.......                                       [ 25%]
tests/test_const.py ....                                                 [ 37%]
tests/test_coordinator.py .......                                        [ 59%]
tests/test_diagnostics.py F                                              [ 62%]
tests/test_entry_lifecycle.py .                                          [ 65%]
tests/test_init.py ....F                                                 [ 81%]
tests/test_options_flow.py .                                             [ 84%]
tests/test_sensor.py ..                                                  [ 90%]
tests/test_sensor_statistics.py ...                                      [100%]

=================================== FAILURES ===================================
_________________________ test_show_user_form_initial __________________________

recorder_mock = <Recorder(Recorder, started 140734871107264)>
enable_custom_integrations = None, hass = <HomeAssistant RUNNING>

    async def test_show_user_form_initial(recorder_mock,  hass):
        """Test that the user step of config flow shows a form with default offset."""
        result = await hass.config_entries.flow.async_init(
            DOMAIN, context={"source": SOURCE_USER}
        )
        assert result["type"] is FlowResultType.FORM
        assert result["step_id"] == "user"
        # Find the schema key for CONF_OFFSET and check its default value.
        # The key is a voluptuous Marker object (Required or Optional).
        offset_key = next(
            (value for key, value in result["data_schema"].schema.items() if key.schema == CONF_OFFSET),
            None,
        )
        print("WWWWWWWWWWw", dir(offset_key))
        assert offset_key is not None
        # `add_suggested_values_to_schema` adds a callable default.
>       assert hasattr(offset_key, "default") and callable(offset_key.default)
E       AssertionError: assert (False)
E        +  where False = hasattr(<homeassistant.helpers.selector.DateSelector object at 0x7fff68704590>, 'default')

tests/test_config_flow.py:34: AssertionError
---------------------------- Captured stderr setup -----------------------------
INFO:homeassistant.loader:Loaded recorder from homeassistant.components.recorder
INFO:homeassistant.setup:Setting up recorder
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("statistics_meta")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("statistics_meta")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("events")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("events")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("event_data")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("event_data")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("event_types")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("event_types")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("states")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("states")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("state_attributes")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("state_attributes")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("states_meta")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("states_meta")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("statistics")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("statistics")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("statistics_short_term")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("statistics_short_term")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("statistics_meta")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("statistics_meta")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("recorder_runs")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("recorder_runs")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("migration_changes")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("migration_changes")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("schema_changes")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("schema_changes")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("statistics_runs")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("statistics_runs")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE event_data (
	data_id INTEGER NOT NULL, 
	hash BIGINT, 
	shared_data TEXT, 
	PRIMARY KEY (data_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00012s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_event_data_hash ON event_data (hash)
INFO:sqlalchemy.engine.Engine:[no key 0.00010s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE event_types (
	event_type_id INTEGER NOT NULL, 
	event_type VARCHAR(64), 
	PRIMARY KEY (event_type_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE UNIQUE INDEX ix_event_types_event_type ON event_types (event_type)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE state_attributes (
	attributes_id INTEGER NOT NULL, 
	hash BIGINT, 
	shared_attrs TEXT, 
	PRIMARY KEY (attributes_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00010s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_state_attributes_hash ON state_attributes (hash)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE states_meta (
	metadata_id INTEGER NOT NULL, 
	entity_id VARCHAR(255), 
	PRIMARY KEY (metadata_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:CREATE UNIQUE INDEX ix_states_meta_entity_id ON states_meta (entity_id)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE statistics_meta (
	id INTEGER NOT NULL, 
	statistic_id VARCHAR(255), 
	source VARCHAR(32), 
	unit_of_measurement VARCHAR(255), 
	has_mean BOOLEAN, 
	has_sum BOOLEAN, 
	name VARCHAR(255), 
	mean_type SMALLINT NOT NULL, 
	PRIMARY KEY (id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE UNIQUE INDEX ix_statistics_meta_statistic_id ON statistics_meta (statistic_id)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE recorder_runs (
	run_id INTEGER NOT NULL, 
	start DATETIME NOT NULL, 
	"end" DATETIME, 
	closed_incorrect BOOLEAN NOT NULL, 
	created DATETIME NOT NULL, 
	PRIMARY KEY (run_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00011s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_recorder_runs_start_end ON recorder_runs (start, "end")
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE migration_changes (
	migration_id VARCHAR(255) NOT NULL, 
	version SMALLINT NOT NULL, 
	PRIMARY KEY (migration_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE schema_changes (
	change_id INTEGER NOT NULL, 
	schema_version INTEGER, 
	changed DATETIME NOT NULL, 
	PRIMARY KEY (change_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE statistics_runs (
	run_id INTEGER NOT NULL, 
	start DATETIME NOT NULL, 
	PRIMARY KEY (run_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_statistics_runs_start ON statistics_runs (start)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE events (
	event_id INTEGER NOT NULL, 
	event_type CHAR(0), 
	event_data CHAR(0), 
	origin CHAR(0), 
	origin_idx SMALLINT, 
	time_fired CHAR(0), 
	time_fired_ts FLOAT, 
	context_id CHAR(0), 
	context_user_id CHAR(0), 
	context_parent_id CHAR(0), 
	data_id INTEGER, 
	context_id_bin BLOB, 
	context_user_id_bin BLOB, 
	context_parent_id_bin BLOB, 
	event_type_id INTEGER, 
	PRIMARY KEY (event_id), 
	FOREIGN KEY(data_id) REFERENCES event_data (data_id), 
	FOREIGN KEY(event_type_id) REFERENCES event_types (event_type_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00011s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_events_context_id_bin ON events (context_id_bin)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_events_event_type_id_time_fired_ts ON events (event_type_id, time_fired_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_events_time_fired_ts ON events (time_fired_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_events_data_id ON events (data_id)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE states (
	state_id INTEGER NOT NULL, 
	entity_id CHAR(0), 
	state VARCHAR(255), 
	attributes CHAR(0), 
	event_id SMALLINT, 
	last_changed CHAR(0), 
	last_changed_ts FLOAT, 
	last_reported_ts FLOAT, 
	last_updated CHAR(0), 
	last_updated_ts FLOAT, 
	old_state_id INTEGER, 
	attributes_id INTEGER, 
	context_id CHAR(0), 
	context_user_id CHAR(0), 
	context_parent_id CHAR(0), 
	origin_idx SMALLINT, 
	context_id_bin BLOB, 
	context_user_id_bin BLOB, 
	context_parent_id_bin BLOB, 
	metadata_id INTEGER, 
	PRIMARY KEY (state_id), 
	FOREIGN KEY(old_state_id) REFERENCES states (state_id), 
	FOREIGN KEY(attributes_id) REFERENCES state_attributes (attributes_id), 
	FOREIGN KEY(metadata_id) REFERENCES states_meta (metadata_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00010s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_states_old_state_id ON states (old_state_id)
INFO:sqlalchemy.engine.Engine:[no key 0.00010s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_states_context_id_bin ON states (context_id_bin)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_states_last_updated_ts ON states (last_updated_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_states_metadata_id_last_updated_ts ON states (metadata_id, last_updated_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_states_attributes_id ON states (attributes_id)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE statistics (
	id INTEGER NOT NULL, 
	created CHAR(0), 
	created_ts FLOAT, 
	metadata_id INTEGER, 
	start CHAR(0), 
	start_ts FLOAT, 
	mean FLOAT, 
	mean_weight FLOAT, 
	min FLOAT, 
	max FLOAT, 
	last_reset CHAR(0), 
	last_reset_ts FLOAT, 
	state FLOAT, 
	sum FLOAT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(metadata_id) REFERENCES statistics_meta (id) ON DELETE CASCADE
)


INFO:sqlalchemy.engine.Engine:[no key 0.00010s] ()
INFO:sqlalchemy.engine.Engine:CREATE UNIQUE INDEX ix_statistics_statistic_id_start_ts ON statistics (metadata_id, start_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_statistics_start_ts ON statistics (start_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE statistics_short_term (
	id INTEGER NOT NULL, 
	created CHAR(0), 
	created_ts FLOAT, 
	metadata_id INTEGER, 
	start CHAR(0), 
	start_ts FLOAT, 
	mean FLOAT, 
	mean_weight FLOAT, 
	min FLOAT, 
	max FLOAT, 
	last_reset CHAR(0), 
	last_reset_ts FLOAT, 
	state FLOAT, 
	sum FLOAT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(metadata_id) REFERENCES statistics_meta (id) ON DELETE CASCADE
)


INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE UNIQUE INDEX ix_statistics_short_term_statistic_id_start_ts ON statistics_short_term (metadata_id, start_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_statistics_short_term_start_ts ON statistics_short_term (start_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT schema_changes.schema_version AS schema_changes_schema_version 
FROM schema_changes ORDER BY schema_changes.change_id DESC
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00026s] (1, 0)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:PRAGMA main.index_list("events")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.index_info("ix_events_data_id")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.index_info("ix_events_time_fired_ts")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.index_info("ix_events_event_type_id_time_fired_ts")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.index_info("ix_events_context_id_bin")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:INSERT INTO schema_changes (schema_version, changed) VALUES (?, ?) RETURNING change_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00021s] (50, '2025-08-03 11:09:47.489009')
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics_runs (start) VALUES (?) RETURNING run_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00014s] ('2025-08-03 11:00:00.000000',)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT schema_changes.schema_version AS schema_changes_schema_version 
FROM schema_changes ORDER BY schema_changes.change_id DESC
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.007612s ago] (1, 0)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT schema_changes.schema_version AS schema_changes_schema_version 
FROM schema_changes ORDER BY schema_changes.change_id ASC
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00014s] (1, 0)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT migration_changes.migration_id, migration_changes.version 
FROM migration_changes
INFO:sqlalchemy.engine.Engine:[generated in 0.00012s] ()
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT recorder_runs.run_id AS recorder_runs_run_id, recorder_runs.start AS recorder_runs_start, recorder_runs."end" AS recorder_runs_end, recorder_runs.closed_incorrect AS recorder_runs_closed_incorrect, recorder_runs.created AS recorder_runs_created 
FROM recorder_runs 
WHERE recorder_runs."end" IS NULL
INFO:sqlalchemy.engine.Engine:[generated in 0.00013s] ()
INFO:sqlalchemy.engine.Engine:INSERT INTO recorder_runs (start, "end", closed_incorrect, created) VALUES (?, ?, ?, ?) RETURNING run_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00019s] ('2025-08-03 11:09:47.452873', None, 0, '2025-08-03 11:09:47.497320')
INFO:sqlalchemy.engine.Engine:SELECT recorder_runs.run_id AS recorder_runs_run_id, recorder_runs.start AS recorder_runs_start, recorder_runs."end" AS recorder_runs_end, recorder_runs.closed_incorrect AS recorder_runs_closed_incorrect, recorder_runs.created AS recorder_runs_created 
FROM recorder_runs ORDER BY recorder_runs.start ASC
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00014s] (1, 0)
INFO:sqlalchemy.engine.Engine:SELECT states.last_updated_ts 
FROM states ORDER BY states.last_updated_ts ASC
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00013s] (1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta
INFO:sqlalchemy.engine.Engine:[generated in 0.00015s] ()
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT migration_changes.migration_id, migration_changes.version 
FROM migration_changes
INFO:sqlalchemy.engine.Engine:[cached since 0.009395s ago] ()
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:pytest_homeassistant_custom_component.plugins:Test recorder successfully started, database location: sqlite://
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?, ?, ?, ?, ?, ?)
INFO:sqlalchemy.engine.Engine:[generated in 0.00025s] (2705000516, 1936967080, 616907209, 3478486156, 2001541813, 2514025343)
INFO:sqlalchemy.engine.Engine:SELECT event_types.event_type_id, event_types.event_type 
FROM event_types 
WHERE event_types.event_type IN (?, ?)
INFO:sqlalchemy.engine.Engine:[generated in 0.00019s] ('component_loaded', 'service_registered')
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.002683s ago] (2514025343,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00014s] (2514025343, '{"domain":"recorder","service":"purge"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO event_types (event_type) VALUES (?) RETURNING event_type_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00013s] ('service_registered',)
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00025s] (None, None, None, 0, None, 1754219387.454987, None, None, None, 1, <memory at 0x7fff6872c040>, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.007977s ago] (2001541813,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.004603s ago] (2001541813, '{"domain":"recorder","service":"purge_entities"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.002695s ago] (None, None, None, 0, None, 1754219387.4550297, None, None, None, 2, <memory at 0x7fff6872c7c0>, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.01012s ago] (616907209,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.006694s ago] (616907209, '{"domain":"recorder","service":"enable"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.004781s ago] (None, None, None, 0, None, 1754219387.4550426, None, None, None, 3, <memory at 0x7fff6872cac0>, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.01223s ago] (3478486156,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.008817s ago] (3478486156, '{"domain":"recorder","service":"disable"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.006891s ago] (None, None, None, 0, None, 1754219387.4550526, None, None, None, 4, <memory at 0x7fff6872cd00>, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.0143s ago] (1936967080,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01087s ago] (1936967080, '{"domain":"recorder","service":"get_statistics"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.008957s ago] (None, None, None, 0, None, 1754219387.4550633, None, None, None, 5, <memory at 0x7fff6872cf40>, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.01643s ago] (2705000516,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01305s ago] (2705000516, '{"component":"recorder"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO event_types (event_type) VALUES (?) RETURNING event_type_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01262s ago] ('component_loaded',)
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01153s ago] (None, None, None, 0, None, 1754219387.5047462, None, None, None, 6, <memory at 0x7fff6872d180>, None, None, 2)
INFO:sqlalchemy.engine.Engine:COMMIT
------------------------------ Captured log setup ------------------------------
INFO     homeassistant.loader:loader.py:774 Loaded recorder from homeassistant.components.recorder
INFO     homeassistant.setup:setup.py:393 Setting up recorder
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("statistics_meta")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("statistics_meta")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("events")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("events")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("event_data")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("event_data")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("event_types")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("event_types")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("states")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("states")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("state_attributes")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("state_attributes")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("states_meta")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("states_meta")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("statistics")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("statistics")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("statistics_short_term")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("statistics_short_term")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("statistics_meta")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("statistics_meta")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("recorder_runs")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("recorder_runs")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("migration_changes")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("migration_changes")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("schema_changes")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("schema_changes")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("statistics_runs")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("statistics_runs")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE event_data (
	data_id INTEGER NOT NULL, 
	hash BIGINT, 
	shared_data TEXT, 
	PRIMARY KEY (data_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00012s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_event_data_hash ON event_data (hash)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00010s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE event_types (
	event_type_id INTEGER NOT NULL, 
	event_type VARCHAR(64), 
	PRIMARY KEY (event_type_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE UNIQUE INDEX ix_event_types_event_type ON event_types (event_type)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE state_attributes (
	attributes_id INTEGER NOT NULL, 
	hash BIGINT, 
	shared_attrs TEXT, 
	PRIMARY KEY (attributes_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00010s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_state_attributes_hash ON state_attributes (hash)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE states_meta (
	metadata_id INTEGER NOT NULL, 
	entity_id VARCHAR(255), 
	PRIMARY KEY (metadata_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE UNIQUE INDEX ix_states_meta_entity_id ON states_meta (entity_id)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE statistics_meta (
	id INTEGER NOT NULL, 
	statistic_id VARCHAR(255), 
	source VARCHAR(32), 
	unit_of_measurement VARCHAR(255), 
	has_mean BOOLEAN, 
	has_sum BOOLEAN, 
	name VARCHAR(255), 
	mean_type SMALLINT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE UNIQUE INDEX ix_statistics_meta_statistic_id ON statistics_meta (statistic_id)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE recorder_runs (
	run_id INTEGER NOT NULL, 
	start DATETIME NOT NULL, 
	"end" DATETIME, 
	closed_incorrect BOOLEAN NOT NULL, 
	created DATETIME NOT NULL, 
	PRIMARY KEY (run_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00011s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_recorder_runs_start_end ON recorder_runs (start, "end")
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE migration_changes (
	migration_id VARCHAR(255) NOT NULL, 
	version SMALLINT NOT NULL, 
	PRIMARY KEY (migration_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE schema_changes (
	change_id INTEGER NOT NULL, 
	schema_version INTEGER, 
	changed DATETIME NOT NULL, 
	PRIMARY KEY (change_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE statistics_runs (
	run_id INTEGER NOT NULL, 
	start DATETIME NOT NULL, 
	PRIMARY KEY (run_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_statistics_runs_start ON statistics_runs (start)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE events (
	event_id INTEGER NOT NULL, 
	event_type CHAR(0), 
	event_data CHAR(0), 
	origin CHAR(0), 
	origin_idx SMALLINT, 
	time_fired CHAR(0), 
	time_fired_ts FLOAT, 
	context_id CHAR(0), 
	context_user_id CHAR(0), 
	context_parent_id CHAR(0), 
	data_id INTEGER, 
	context_id_bin BLOB, 
	context_user_id_bin BLOB, 
	context_parent_id_bin BLOB, 
	event_type_id INTEGER, 
	PRIMARY KEY (event_id), 
	FOREIGN KEY(data_id) REFERENCES event_data (data_id), 
	FOREIGN KEY(event_type_id) REFERENCES event_types (event_type_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00011s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_events_context_id_bin ON events (context_id_bin)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_events_event_type_id_time_fired_ts ON events (event_type_id, time_fired_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_events_time_fired_ts ON events (time_fired_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_events_data_id ON events (data_id)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE states (
	state_id INTEGER NOT NULL, 
	entity_id CHAR(0), 
	state VARCHAR(255), 
	attributes CHAR(0), 
	event_id SMALLINT, 
	last_changed CHAR(0), 
	last_changed_ts FLOAT, 
	last_reported_ts FLOAT, 
	last_updated CHAR(0), 
	last_updated_ts FLOAT, 
	old_state_id INTEGER, 
	attributes_id INTEGER, 
	context_id CHAR(0), 
	context_user_id CHAR(0), 
	context_parent_id CHAR(0), 
	origin_idx SMALLINT, 
	context_id_bin BLOB, 
	context_user_id_bin BLOB, 
	context_parent_id_bin BLOB, 
	metadata_id INTEGER, 
	PRIMARY KEY (state_id), 
	FOREIGN KEY(old_state_id) REFERENCES states (state_id), 
	FOREIGN KEY(attributes_id) REFERENCES state_attributes (attributes_id), 
	FOREIGN KEY(metadata_id) REFERENCES states_meta (metadata_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00010s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_states_old_state_id ON states (old_state_id)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00010s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_states_context_id_bin ON states (context_id_bin)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_states_last_updated_ts ON states (last_updated_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_states_metadata_id_last_updated_ts ON states (metadata_id, last_updated_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_states_attributes_id ON states (attributes_id)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE statistics (
	id INTEGER NOT NULL, 
	created CHAR(0), 
	created_ts FLOAT, 
	metadata_id INTEGER, 
	start CHAR(0), 
	start_ts FLOAT, 
	mean FLOAT, 
	mean_weight FLOAT, 
	min FLOAT, 
	max FLOAT, 
	last_reset CHAR(0), 
	last_reset_ts FLOAT, 
	state FLOAT, 
	sum FLOAT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(metadata_id) REFERENCES statistics_meta (id) ON DELETE CASCADE
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00010s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE UNIQUE INDEX ix_statistics_statistic_id_start_ts ON statistics (metadata_id, start_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_statistics_start_ts ON statistics (start_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE statistics_short_term (
	id INTEGER NOT NULL, 
	created CHAR(0), 
	created_ts FLOAT, 
	metadata_id INTEGER, 
	start CHAR(0), 
	start_ts FLOAT, 
	mean FLOAT, 
	mean_weight FLOAT, 
	min FLOAT, 
	max FLOAT, 
	last_reset CHAR(0), 
	last_reset_ts FLOAT, 
	state FLOAT, 
	sum FLOAT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(metadata_id) REFERENCES statistics_meta (id) ON DELETE CASCADE
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE UNIQUE INDEX ix_statistics_short_term_statistic_id_start_ts ON statistics_short_term (metadata_id, start_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_statistics_short_term_start_ts ON statistics_short_term (start_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT schema_changes.schema_version AS schema_changes_schema_version 
FROM schema_changes ORDER BY schema_changes.change_id DESC
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00026s] (1, 0)
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.index_list("events")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.index_info("ix_events_data_id")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.index_info("ix_events_time_fired_ts")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.index_info("ix_events_event_type_id_time_fired_ts")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.index_info("ix_events_context_id_bin")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO schema_changes (schema_version, changed) VALUES (?, ?) RETURNING change_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00021s] (50, '2025-08-03 11:09:47.489009')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics_runs (start) VALUES (?) RETURNING run_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00014s] ('2025-08-03 11:00:00.000000',)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT schema_changes.schema_version AS schema_changes_schema_version 
FROM schema_changes ORDER BY schema_changes.change_id DESC
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.007612s ago] (1, 0)
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT schema_changes.schema_version AS schema_changes_schema_version 
FROM schema_changes ORDER BY schema_changes.change_id ASC
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00014s] (1, 0)
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT migration_changes.migration_id, migration_changes.version 
FROM migration_changes
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00012s] ()
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT recorder_runs.run_id AS recorder_runs_run_id, recorder_runs.start AS recorder_runs_start, recorder_runs."end" AS recorder_runs_end, recorder_runs.closed_incorrect AS recorder_runs_closed_incorrect, recorder_runs.created AS recorder_runs_created 
FROM recorder_runs 
WHERE recorder_runs."end" IS NULL
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO recorder_runs (start, "end", closed_incorrect, created) VALUES (?, ?, ?, ?) RETURNING run_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00019s] ('2025-08-03 11:09:47.452873', None, 0, '2025-08-03 11:09:47.497320')
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT recorder_runs.run_id AS recorder_runs_run_id, recorder_runs.start AS recorder_runs_start, recorder_runs."end" AS recorder_runs_end, recorder_runs.closed_incorrect AS recorder_runs_closed_incorrect, recorder_runs.created AS recorder_runs_created 
FROM recorder_runs ORDER BY recorder_runs.start ASC
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00014s] (1, 0)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT states.last_updated_ts 
FROM states ORDER BY states.last_updated_ts ASC
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00013s] (1, 0)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT migration_changes.migration_id, migration_changes.version 
FROM migration_changes
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.009395s ago] ()
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     pytest_homeassistant_custom_component.plugins:plugins.py:1567 Test recorder successfully started, database location: sqlite://
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00025s] (2705000516, 1936967080, 616907209, 3478486156, 2001541813, 2514025343)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_types.event_type_id, event_types.event_type 
FROM event_types 
WHERE event_types.event_type IN (?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00019s] ('component_loaded', 'service_registered')
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.002683s ago] (2514025343,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00014s] (2514025343, '{"domain":"recorder","service":"purge"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_types (event_type) VALUES (?) RETURNING event_type_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00013s] ('service_registered',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00025s] (None, None, None, 0, None, 1754219387.454987, None, None, None, 1, <memory at 0x7fff6872c040>, None, None, 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.007977s ago] (2001541813,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.004603s ago] (2001541813, '{"domain":"recorder","service":"purge_entities"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.002695s ago] (None, None, None, 0, None, 1754219387.4550297, None, None, None, 2, <memory at 0x7fff6872c7c0>, None, None, 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01012s ago] (616907209,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.006694s ago] (616907209, '{"domain":"recorder","service":"enable"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.004781s ago] (None, None, None, 0, None, 1754219387.4550426, None, None, None, 3, <memory at 0x7fff6872cac0>, None, None, 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01223s ago] (3478486156,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.008817s ago] (3478486156, '{"domain":"recorder","service":"disable"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.006891s ago] (None, None, None, 0, None, 1754219387.4550526, None, None, None, 4, <memory at 0x7fff6872cd00>, None, None, 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.0143s ago] (1936967080,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01087s ago] (1936967080, '{"domain":"recorder","service":"get_statistics"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.008957s ago] (None, None, None, 0, None, 1754219387.4550633, None, None, None, 5, <memory at 0x7fff6872cf40>, None, None, 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01643s ago] (2705000516,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01305s ago] (2705000516, '{"component":"recorder"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_types (event_type) VALUES (?) RETURNING event_type_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01262s ago] ('component_loaded',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01153s ago] (None, None, None, 0, None, 1754219387.5047462, None, None, None, 6, <memory at 0x7fff6872d180>, None, None, 2)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
----------------------------- Captured stdout call -----------------------------
WWWWWWWWWWw ['CONFIG_SCHEMA', '__annotations__', '__call__', '__class__', '__class_getitem__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__orig_bases__', '__parameters__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__type_params__', '__weakref__', 'config', 'selector_type', 'serialize']
----------------------------- Captured stderr call -----------------------------
INFO:homeassistant.loader:Loaded ista_calista from custom_components.ista_calista
WARNING:homeassistant.loader:We found a custom integration ista_calista which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
------------------------------ Captured log call -------------------------------
INFO     homeassistant.loader:loader.py:774 Loaded ista_calista from custom_components.ista_calista
WARNING  homeassistant.loader:loader.py:690 We found a custom integration ista_calista which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
--------------------------- Captured stderr teardown ---------------------------
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:UPDATE recorder_runs SET "end"=? WHERE recorder_runs.run_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00022s] ('2025-08-03 11:09:47.559258', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:homeassistant.components.recorder.pool.MutexPool:Pool recreating
---------------------------- Captured log teardown -----------------------------
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 UPDATE recorder_runs SET "end"=? WHERE recorder_runs.run_id = ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00022s] ('2025-08-03 11:09:47.559258', 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     homeassistant.components.recorder.pool.MutexPool:impl.py:478 Pool recreating
_______________________________ test_diagnostics _______________________________

hass = <HomeAssistant RUNNING>
hass_client = <function hass_client.<locals>.auth_client at 0x7fff69fa42c0>
mock_pycalista = <MagicMock id='140734945585408'>
enable_custom_integrations = None

    async def test_diagnostics(hass, hass_client, mock_pycalista, enable_custom_integrations):
        """Test diagnostics."""
        # The hass_client fixture requires the http component to be set up.
        assert await async_setup_component(hass, "http", {})
        assert await async_setup_component(hass, "diagnostics", {})
    
        mock_pycalista.get_devices_history.return_value = MOCK_DEVICES
        entry = MockConfigEntry(
            domain=DOMAIN, data=MOCK_CONFIG, unique_id=MOCK_CONFIG["email"]
        )
        entry.add_to_hass(hass)
    
        await hass.config_entries.async_setup(entry.entry_id)
        await hass.async_block_till_done()
    
        # Manually call the diagnostics endpoint as the helper is not available
        # in all test environments.
        client = await hass_client()
        response = await client.get(f"/api/diagnostics/config_entry/{entry.entry_id}")
>       assert response.status == HTTPStatus.OK
E       AssertionError: assert 404 == <HTTPStatus.OK: 200>
E        +  where 404 = <ClientResponse(http://127.0.0.1:45661/api/diagnostics/config_entry/01K1QSZ8MQFNWW557SYCVC4MBB) [404 Not Found]>\n<CIMu...niff', 'Server': '', 'X-Frame-Options': 'SAMEORIGIN', 'Content-Length': '0', 'Date': 'Sun, 03 Aug 2025 11:09:49 GMT')>\n.status
E        +  and   <HTTPStatus.OK: 200> = HTTPStatus.OK

tests/test_diagnostics.py:31: AssertionError
----------------------------- Captured stderr call -----------------------------
INFO:homeassistant.loader:Loaded ista_calista from custom_components.ista_calista
WARNING:homeassistant.loader:We found a custom integration ista_calista which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
INFO:homeassistant.loader:Loaded http from homeassistant.components.http
INFO:homeassistant.setup:Setting up http
WARNING:aiohttp_fast_zlib:zlib_ng and isal are not available, falling back to zlib, performance will be degraded.
INFO:homeassistant.loader:Loaded diagnostics from homeassistant.components.diagnostics
INFO:homeassistant.setup:Setting up diagnostics
INFO:homeassistant.setup:Setting up ista_calista
INFO:custom_components.ista_calista:Successfully logged in for account test@example.com
INFO:custom_components.ista_calista.coordinator:Initial fetch successful. Discovered 3 device(s).
INFO:homeassistant.loader:Loaded sensor from homeassistant.components.sensor
INFO:homeassistant.setup:Setting up sensor
INFO:homeassistant.components.sensor:Setting up ista_calista.sensor
INFO:custom_components.ista_calista.sensor:Adding 6 new Ista Calista sensor entities.
INFO:homeassistant.helpers.entity_registry:Registered new sensor.ista_calista entity: sensor.living_room_energy
INFO:homeassistant.helpers.entity_registry:Registered new sensor.ista_calista entity: sensor.living_room_timestamp
INFO:homeassistant.helpers.entity_registry:Registered new sensor.ista_calista entity: sensor.bathroom_water
INFO:homeassistant.helpers.entity_registry:Registered new sensor.ista_calista entity: sensor.bathroom_timestamp
INFO:homeassistant.helpers.entity_registry:Registered new sensor.ista_calista entity: sensor.kitchen_water
INFO:homeassistant.helpers.entity_registry:Registered new sensor.ista_calista entity: sensor.kitchen_timestamp
INFO:aiohttp.access:127.0.0.1 [03/Aug/2025:12:09:49 +0100] "GET /api/diagnostics/config_entry/01K1QSZ8MQFNWW557SYCVC4MBB HTTP/1.1" 404 184 "-" "Python/3.13 aiohttp/3.12.14"
------------------------------ Captured log call -------------------------------
INFO     homeassistant.loader:loader.py:774 Loaded ista_calista from custom_components.ista_calista
WARNING  homeassistant.loader:loader.py:690 We found a custom integration ista_calista which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
INFO     homeassistant.loader:loader.py:774 Loaded http from homeassistant.components.http
INFO     homeassistant.setup:setup.py:393 Setting up http
WARNING  aiohttp_fast_zlib:__init__.py:55 zlib_ng and isal are not available, falling back to zlib, performance will be degraded.
INFO     homeassistant.loader:loader.py:774 Loaded diagnostics from homeassistant.components.diagnostics
INFO     homeassistant.setup:setup.py:393 Setting up diagnostics
INFO     homeassistant.setup:setup.py:393 Setting up ista_calista
INFO     custom_components.ista_calista:__init__.py:81 Successfully logged in for account test@example.com
INFO     custom_components.ista_calista.coordinator:coordinator.py:100 Initial fetch successful. Discovered 3 device(s).
INFO     homeassistant.loader:loader.py:774 Loaded sensor from homeassistant.components.sensor
INFO     homeassistant.setup:setup.py:393 Setting up sensor
INFO     homeassistant.components.sensor:entity_platform.py:367 Setting up ista_calista.sensor
INFO     custom_components.ista_calista.sensor:sensor.py:135 Adding 6 new Ista Calista sensor entities.
INFO     homeassistant.helpers.entity_registry:entity_registry.py:1032 Registered new sensor.ista_calista entity: sensor.living_room_energy
INFO     homeassistant.helpers.entity_registry:entity_registry.py:1032 Registered new sensor.ista_calista entity: sensor.living_room_timestamp
INFO     homeassistant.helpers.entity_registry:entity_registry.py:1032 Registered new sensor.ista_calista entity: sensor.bathroom_water
INFO     homeassistant.helpers.entity_registry:entity_registry.py:1032 Registered new sensor.ista_calista entity: sensor.bathroom_timestamp
INFO     homeassistant.helpers.entity_registry:entity_registry.py:1032 Registered new sensor.ista_calista entity: sensor.kitchen_water
INFO     homeassistant.helpers.entity_registry:entity_registry.py:1032 Registered new sensor.ista_calista entity: sensor.kitchen_timestamp
INFO     aiohttp.access:web_log.py:214 127.0.0.1 [03/Aug/2025:12:09:49 +0100] "GET /api/diagnostics/config_entry/01K1QSZ8MQFNWW557SYCVC4MBB HTTP/1.1" 404 184 "-" "Python/3.13 aiohttp/3.12.14"
--------------------------- Captured stderr teardown ---------------------------
INFO:custom_components.ista_calista:Successfully unloaded config entry: 01K1QSZ8MQFNWW557SYCVC4MBB
---------------------------- Captured log teardown -----------------------------
INFO     custom_components.ista_calista:__init__.py:124 Successfully unloaded config entry: 01K1QSZ8MQFNWW557SYCVC4MBB
________________________ test_remove_entry_clears_stats ________________________

recorder_mock = <Recorder(Recorder, started 140734862714560)>
enable_custom_integrations = None, hass = <HomeAssistant RUNNING>
mock_pycalista = <MagicMock id='140734969879856'>

    async def test_remove_entry_clears_stats(
        recorder_mock,  hass, enable_custom_integrations, mock_pycalista
    ):
        """Test that removing the config entry clears associated statistics."""
        mock_pycalista.get_devices_history.return_value = MOCK_DEVICES
        entry = MockConfigEntry(domain=DOMAIN, data=MOCK_CONFIG, unique_id=MOCK_CONFIG["email"])
        entry.add_to_hass(hass)
    
        # Setup the component and entities
        await hass.config_entries.async_setup(entry.entry_id)
        await hass.async_block_till_done()
    
        # Get the devices before they are removed. The device registry is cleared
        # before async_remove_entry is called.
        device_registry = dr.async_get(hass)
        devices = dr.async_entries_for_config_entry(device_registry, entry.entry_id)
    
        with patch(
            "homeassistant.components.recorder.get_instance"
>       ) as mock_get_instance, patch(
            "homeassistant.helpers.device_registry.DeviceRegistry.async_entries_for_config_entry",
            return_value=devices,
        ) as mock_dr:

tests/test_init.py:72: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/nix/store/9yh9ak97gn659bk4d3n411fx6c0ng7s2-python3-3.13.5/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <unittest.mock._patch object at 0x7fff69c935b0>

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
>           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: <class 'homeassistant.helpers.device_registry.DeviceRegistry'> does not have the attribute 'async_entries_for_config_entry'

/nix/store/9yh9ak97gn659bk4d3n411fx6c0ng7s2-python3-3.13.5/lib/python3.13/unittest/mock.py:1467: AttributeError
---------------------------- Captured stderr setup -----------------------------
INFO:homeassistant.loader:Loaded recorder from homeassistant.components.recorder
INFO:homeassistant.setup:Setting up recorder
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("statistics_meta")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("statistics_meta")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("events")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("events")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("event_data")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("event_data")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("event_types")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("event_types")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("states")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("states")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("state_attributes")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("state_attributes")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("states_meta")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("states_meta")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("statistics")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("statistics")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("statistics_short_term")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("statistics_short_term")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("statistics_meta")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("statistics_meta")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("recorder_runs")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("recorder_runs")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("migration_changes")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("migration_changes")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("schema_changes")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("schema_changes")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("statistics_runs")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA temp.table_info("statistics_runs")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE event_data (
	data_id INTEGER NOT NULL, 
	hash BIGINT, 
	shared_data TEXT, 
	PRIMARY KEY (data_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00010s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_event_data_hash ON event_data (hash)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE event_types (
	event_type_id INTEGER NOT NULL, 
	event_type VARCHAR(64), 
	PRIMARY KEY (event_type_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE UNIQUE INDEX ix_event_types_event_type ON event_types (event_type)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE state_attributes (
	attributes_id INTEGER NOT NULL, 
	hash BIGINT, 
	shared_attrs TEXT, 
	PRIMARY KEY (attributes_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00010s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_state_attributes_hash ON state_attributes (hash)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE states_meta (
	metadata_id INTEGER NOT NULL, 
	entity_id VARCHAR(255), 
	PRIMARY KEY (metadata_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00011s] ()
INFO:sqlalchemy.engine.Engine:CREATE UNIQUE INDEX ix_states_meta_entity_id ON states_meta (entity_id)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE statistics_meta (
	id INTEGER NOT NULL, 
	statistic_id VARCHAR(255), 
	source VARCHAR(32), 
	unit_of_measurement VARCHAR(255), 
	has_mean BOOLEAN, 
	has_sum BOOLEAN, 
	name VARCHAR(255), 
	mean_type SMALLINT NOT NULL, 
	PRIMARY KEY (id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00011s] ()
INFO:sqlalchemy.engine.Engine:CREATE UNIQUE INDEX ix_statistics_meta_statistic_id ON statistics_meta (statistic_id)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE recorder_runs (
	run_id INTEGER NOT NULL, 
	start DATETIME NOT NULL, 
	"end" DATETIME, 
	closed_incorrect BOOLEAN NOT NULL, 
	created DATETIME NOT NULL, 
	PRIMARY KEY (run_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_recorder_runs_start_end ON recorder_runs (start, "end")
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE migration_changes (
	migration_id VARCHAR(255) NOT NULL, 
	version SMALLINT NOT NULL, 
	PRIMARY KEY (migration_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE schema_changes (
	change_id INTEGER NOT NULL, 
	schema_version INTEGER, 
	changed DATETIME NOT NULL, 
	PRIMARY KEY (change_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00011s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE statistics_runs (
	run_id INTEGER NOT NULL, 
	start DATETIME NOT NULL, 
	PRIMARY KEY (run_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_statistics_runs_start ON statistics_runs (start)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE events (
	event_id INTEGER NOT NULL, 
	event_type CHAR(0), 
	event_data CHAR(0), 
	origin CHAR(0), 
	origin_idx SMALLINT, 
	time_fired CHAR(0), 
	time_fired_ts FLOAT, 
	context_id CHAR(0), 
	context_user_id CHAR(0), 
	context_parent_id CHAR(0), 
	data_id INTEGER, 
	context_id_bin BLOB, 
	context_user_id_bin BLOB, 
	context_parent_id_bin BLOB, 
	event_type_id INTEGER, 
	PRIMARY KEY (event_id), 
	FOREIGN KEY(data_id) REFERENCES event_data (data_id), 
	FOREIGN KEY(event_type_id) REFERENCES event_types (event_type_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00011s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_events_context_id_bin ON events (context_id_bin)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_events_event_type_id_time_fired_ts ON events (event_type_id, time_fired_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_events_time_fired_ts ON events (time_fired_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_events_data_id ON events (data_id)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE states (
	state_id INTEGER NOT NULL, 
	entity_id CHAR(0), 
	state VARCHAR(255), 
	attributes CHAR(0), 
	event_id SMALLINT, 
	last_changed CHAR(0), 
	last_changed_ts FLOAT, 
	last_reported_ts FLOAT, 
	last_updated CHAR(0), 
	last_updated_ts FLOAT, 
	old_state_id INTEGER, 
	attributes_id INTEGER, 
	context_id CHAR(0), 
	context_user_id CHAR(0), 
	context_parent_id CHAR(0), 
	origin_idx SMALLINT, 
	context_id_bin BLOB, 
	context_user_id_bin BLOB, 
	context_parent_id_bin BLOB, 
	metadata_id INTEGER, 
	PRIMARY KEY (state_id), 
	FOREIGN KEY(old_state_id) REFERENCES states (state_id), 
	FOREIGN KEY(attributes_id) REFERENCES state_attributes (attributes_id), 
	FOREIGN KEY(metadata_id) REFERENCES states_meta (metadata_id)
)


INFO:sqlalchemy.engine.Engine:[no key 0.00011s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_states_old_state_id ON states (old_state_id)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_states_context_id_bin ON states (context_id_bin)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_states_last_updated_ts ON states (last_updated_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_states_metadata_id_last_updated_ts ON states (metadata_id, last_updated_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_states_attributes_id ON states (attributes_id)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE statistics (
	id INTEGER NOT NULL, 
	created CHAR(0), 
	created_ts FLOAT, 
	metadata_id INTEGER, 
	start CHAR(0), 
	start_ts FLOAT, 
	mean FLOAT, 
	mean_weight FLOAT, 
	min FLOAT, 
	max FLOAT, 
	last_reset CHAR(0), 
	last_reset_ts FLOAT, 
	state FLOAT, 
	sum FLOAT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(metadata_id) REFERENCES statistics_meta (id) ON DELETE CASCADE
)


INFO:sqlalchemy.engine.Engine:[no key 0.00013s] ()
INFO:sqlalchemy.engine.Engine:CREATE UNIQUE INDEX ix_statistics_statistic_id_start_ts ON statistics (metadata_id, start_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00010s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_statistics_start_ts ON statistics (start_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:
CREATE TABLE statistics_short_term (
	id INTEGER NOT NULL, 
	created CHAR(0), 
	created_ts FLOAT, 
	metadata_id INTEGER, 
	start CHAR(0), 
	start_ts FLOAT, 
	mean FLOAT, 
	mean_weight FLOAT, 
	min FLOAT, 
	max FLOAT, 
	last_reset CHAR(0), 
	last_reset_ts FLOAT, 
	state FLOAT, 
	sum FLOAT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(metadata_id) REFERENCES statistics_meta (id) ON DELETE CASCADE
)


INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE UNIQUE INDEX ix_statistics_short_term_statistic_id_start_ts ON statistics_short_term (metadata_id, start_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00009s] ()
INFO:sqlalchemy.engine.Engine:CREATE INDEX ix_statistics_short_term_start_ts ON statistics_short_term (start_ts)
INFO:sqlalchemy.engine.Engine:[no key 0.00008s] ()
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT schema_changes.schema_version AS schema_changes_schema_version 
FROM schema_changes ORDER BY schema_changes.change_id DESC
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00017s] (1, 0)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:PRAGMA main.index_list("events")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.index_info("ix_events_data_id")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.index_info("ix_events_time_fired_ts")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.index_info("ix_events_event_type_id_time_fired_ts")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.index_info("ix_events_context_id_bin")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:INSERT INTO schema_changes (schema_version, changed) VALUES (?, ?) RETURNING change_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00017s] (50, '2025-08-03 11:09:50.167918')
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics_runs (start) VALUES (?) RETURNING run_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00016s] ('2025-08-03 11:00:00.000000',)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT schema_changes.schema_version AS schema_changes_schema_version 
FROM schema_changes ORDER BY schema_changes.change_id DESC
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.004896s ago] (1, 0)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT schema_changes.schema_version AS schema_changes_schema_version 
FROM schema_changes ORDER BY schema_changes.change_id ASC
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00014s] (1, 0)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT migration_changes.migration_id, migration_changes.version 
FROM migration_changes
INFO:sqlalchemy.engine.Engine:[generated in 0.00012s] ()
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT recorder_runs.run_id AS recorder_runs_run_id, recorder_runs.start AS recorder_runs_start, recorder_runs."end" AS recorder_runs_end, recorder_runs.closed_incorrect AS recorder_runs_closed_incorrect, recorder_runs.created AS recorder_runs_created 
FROM recorder_runs 
WHERE recorder_runs."end" IS NULL
INFO:sqlalchemy.engine.Engine:[generated in 0.00014s] ()
INFO:sqlalchemy.engine.Engine:INSERT INTO recorder_runs (start, "end", closed_incorrect, created) VALUES (?, ?, ?, ?) RETURNING run_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00018s] ('2025-08-03 11:09:50.142153', None, 0, '2025-08-03 11:09:50.174180')
INFO:sqlalchemy.engine.Engine:SELECT recorder_runs.run_id AS recorder_runs_run_id, recorder_runs.start AS recorder_runs_start, recorder_runs."end" AS recorder_runs_end, recorder_runs.closed_incorrect AS recorder_runs_closed_incorrect, recorder_runs.created AS recorder_runs_created 
FROM recorder_runs ORDER BY recorder_runs.start ASC
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00018s] (1, 0)
INFO:sqlalchemy.engine.Engine:SELECT states.last_updated_ts 
FROM states ORDER BY states.last_updated_ts ASC
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00015s] (1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta
INFO:sqlalchemy.engine.Engine:[generated in 0.00013s] ()
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT migration_changes.migration_id, migration_changes.version 
FROM migration_changes
INFO:sqlalchemy.engine.Engine:[cached since 0.007166s ago] ()
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:pytest_homeassistant_custom_component.plugins:Test recorder successfully started, database location: sqlite://
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?, ?, ?, ?, ?, ?)
INFO:sqlalchemy.engine.Engine:[generated in 0.00019s] (2705000516, 1936967080, 616907209, 3478486156, 2001541813, 2514025343)
INFO:sqlalchemy.engine.Engine:SELECT event_types.event_type_id, event_types.event_type 
FROM event_types 
WHERE event_types.event_type IN (?, ?)
INFO:sqlalchemy.engine.Engine:[generated in 0.00018s] ('component_loaded', 'service_registered')
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.001787s ago] (2514025343,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00015s] (2514025343, '{"domain":"recorder","service":"purge"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO event_types (event_type) VALUES (?) RETURNING event_type_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00015s] ('service_registered',)
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00027s] (None, None, None, 0, None, 1754219390.1430354, None, None, None, 1, <memory at 0x7fff69c8e200>, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.006241s ago] (2001541813,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.004281s ago] (2001541813, '{"domain":"recorder","service":"purge_entities"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.002628s ago] (None, None, None, 0, None, 1754219390.1430671, None, None, None, 2, <memory at 0x7fff69c8e440>, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.008479s ago] (616907209,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.006442s ago] (616907209, '{"domain":"recorder","service":"enable"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.004759s ago] (None, None, None, 0, None, 1754219390.1430795, None, None, None, 3, <memory at 0x7fff69c8e680>, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.01058s ago] (3478486156,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.008622s ago] (3478486156, '{"domain":"recorder","service":"disable"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.006987s ago] (None, None, None, 0, None, 1754219390.1431007, None, None, None, 4, <memory at 0x7fff69c8e8c0>, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.01279s ago] (1936967080,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01072s ago] (1936967080, '{"domain":"recorder","service":"get_statistics"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.009074s ago] (None, None, None, 0, None, 1754219390.1431117, None, None, None, 5, <memory at 0x7fff69c8eb00>, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.01495s ago] (2705000516,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01295s ago] (2705000516, '{"component":"recorder"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO event_types (event_type) VALUES (?) RETURNING event_type_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01244s ago] ('component_loaded',)
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01171s ago] (None, None, None, 0, None, 1754219390.1800928, None, None, None, 6, <memory at 0x7fff69c8ed40>, None, None, 2)
INFO:sqlalchemy.engine.Engine:COMMIT
------------------------------ Captured log setup ------------------------------
INFO     homeassistant.loader:loader.py:774 Loaded recorder from homeassistant.components.recorder
INFO     homeassistant.setup:setup.py:393 Setting up recorder
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("statistics_meta")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("statistics_meta")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("events")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("events")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("event_data")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("event_data")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("event_types")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("event_types")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("states")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("states")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("state_attributes")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("state_attributes")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("states_meta")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("states_meta")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("statistics")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("statistics")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("statistics_short_term")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("statistics_short_term")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("statistics_meta")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("statistics_meta")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("recorder_runs")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("recorder_runs")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("migration_changes")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("migration_changes")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("schema_changes")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("schema_changes")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("statistics_runs")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA temp.table_info("statistics_runs")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE event_data (
	data_id INTEGER NOT NULL, 
	hash BIGINT, 
	shared_data TEXT, 
	PRIMARY KEY (data_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00010s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_event_data_hash ON event_data (hash)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE event_types (
	event_type_id INTEGER NOT NULL, 
	event_type VARCHAR(64), 
	PRIMARY KEY (event_type_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE UNIQUE INDEX ix_event_types_event_type ON event_types (event_type)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE state_attributes (
	attributes_id INTEGER NOT NULL, 
	hash BIGINT, 
	shared_attrs TEXT, 
	PRIMARY KEY (attributes_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00010s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_state_attributes_hash ON state_attributes (hash)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE states_meta (
	metadata_id INTEGER NOT NULL, 
	entity_id VARCHAR(255), 
	PRIMARY KEY (metadata_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00011s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE UNIQUE INDEX ix_states_meta_entity_id ON states_meta (entity_id)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE statistics_meta (
	id INTEGER NOT NULL, 
	statistic_id VARCHAR(255), 
	source VARCHAR(32), 
	unit_of_measurement VARCHAR(255), 
	has_mean BOOLEAN, 
	has_sum BOOLEAN, 
	name VARCHAR(255), 
	mean_type SMALLINT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00011s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE UNIQUE INDEX ix_statistics_meta_statistic_id ON statistics_meta (statistic_id)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE recorder_runs (
	run_id INTEGER NOT NULL, 
	start DATETIME NOT NULL, 
	"end" DATETIME, 
	closed_incorrect BOOLEAN NOT NULL, 
	created DATETIME NOT NULL, 
	PRIMARY KEY (run_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_recorder_runs_start_end ON recorder_runs (start, "end")
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE migration_changes (
	migration_id VARCHAR(255) NOT NULL, 
	version SMALLINT NOT NULL, 
	PRIMARY KEY (migration_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE schema_changes (
	change_id INTEGER NOT NULL, 
	schema_version INTEGER, 
	changed DATETIME NOT NULL, 
	PRIMARY KEY (change_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00011s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE statistics_runs (
	run_id INTEGER NOT NULL, 
	start DATETIME NOT NULL, 
	PRIMARY KEY (run_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_statistics_runs_start ON statistics_runs (start)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE events (
	event_id INTEGER NOT NULL, 
	event_type CHAR(0), 
	event_data CHAR(0), 
	origin CHAR(0), 
	origin_idx SMALLINT, 
	time_fired CHAR(0), 
	time_fired_ts FLOAT, 
	context_id CHAR(0), 
	context_user_id CHAR(0), 
	context_parent_id CHAR(0), 
	data_id INTEGER, 
	context_id_bin BLOB, 
	context_user_id_bin BLOB, 
	context_parent_id_bin BLOB, 
	event_type_id INTEGER, 
	PRIMARY KEY (event_id), 
	FOREIGN KEY(data_id) REFERENCES event_data (data_id), 
	FOREIGN KEY(event_type_id) REFERENCES event_types (event_type_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00011s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_events_context_id_bin ON events (context_id_bin)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_events_event_type_id_time_fired_ts ON events (event_type_id, time_fired_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_events_time_fired_ts ON events (time_fired_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_events_data_id ON events (data_id)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE states (
	state_id INTEGER NOT NULL, 
	entity_id CHAR(0), 
	state VARCHAR(255), 
	attributes CHAR(0), 
	event_id SMALLINT, 
	last_changed CHAR(0), 
	last_changed_ts FLOAT, 
	last_reported_ts FLOAT, 
	last_updated CHAR(0), 
	last_updated_ts FLOAT, 
	old_state_id INTEGER, 
	attributes_id INTEGER, 
	context_id CHAR(0), 
	context_user_id CHAR(0), 
	context_parent_id CHAR(0), 
	origin_idx SMALLINT, 
	context_id_bin BLOB, 
	context_user_id_bin BLOB, 
	context_parent_id_bin BLOB, 
	metadata_id INTEGER, 
	PRIMARY KEY (state_id), 
	FOREIGN KEY(old_state_id) REFERENCES states (state_id), 
	FOREIGN KEY(attributes_id) REFERENCES state_attributes (attributes_id), 
	FOREIGN KEY(metadata_id) REFERENCES states_meta (metadata_id)
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00011s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_states_old_state_id ON states (old_state_id)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_states_context_id_bin ON states (context_id_bin)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_states_last_updated_ts ON states (last_updated_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_states_metadata_id_last_updated_ts ON states (metadata_id, last_updated_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_states_attributes_id ON states (attributes_id)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE statistics (
	id INTEGER NOT NULL, 
	created CHAR(0), 
	created_ts FLOAT, 
	metadata_id INTEGER, 
	start CHAR(0), 
	start_ts FLOAT, 
	mean FLOAT, 
	mean_weight FLOAT, 
	min FLOAT, 
	max FLOAT, 
	last_reset CHAR(0), 
	last_reset_ts FLOAT, 
	state FLOAT, 
	sum FLOAT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(metadata_id) REFERENCES statistics_meta (id) ON DELETE CASCADE
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE UNIQUE INDEX ix_statistics_statistic_id_start_ts ON statistics (metadata_id, start_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00010s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_statistics_start_ts ON statistics (start_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
CREATE TABLE statistics_short_term (
	id INTEGER NOT NULL, 
	created CHAR(0), 
	created_ts FLOAT, 
	metadata_id INTEGER, 
	start CHAR(0), 
	start_ts FLOAT, 
	mean FLOAT, 
	mean_weight FLOAT, 
	min FLOAT, 
	max FLOAT, 
	last_reset CHAR(0), 
	last_reset_ts FLOAT, 
	state FLOAT, 
	sum FLOAT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(metadata_id) REFERENCES statistics_meta (id) ON DELETE CASCADE
)


INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE UNIQUE INDEX ix_statistics_short_term_statistic_id_start_ts ON statistics_short_term (metadata_id, start_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00009s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 CREATE INDEX ix_statistics_short_term_start_ts ON statistics_short_term (start_ts)
INFO     sqlalchemy.engine.Engine:base.py:1842 [no key 0.00008s] ()
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT schema_changes.schema_version AS schema_changes_schema_version 
FROM schema_changes ORDER BY schema_changes.change_id DESC
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00017s] (1, 0)
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.index_list("events")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.index_info("ix_events_data_id")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.index_info("ix_events_time_fired_ts")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.index_info("ix_events_event_type_id_time_fired_ts")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.index_info("ix_events_context_id_bin")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO schema_changes (schema_version, changed) VALUES (?, ?) RETURNING change_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00017s] (50, '2025-08-03 11:09:50.167918')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics_runs (start) VALUES (?) RETURNING run_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00016s] ('2025-08-03 11:00:00.000000',)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT schema_changes.schema_version AS schema_changes_schema_version 
FROM schema_changes ORDER BY schema_changes.change_id DESC
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.004896s ago] (1, 0)
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT schema_changes.schema_version AS schema_changes_schema_version 
FROM schema_changes ORDER BY schema_changes.change_id ASC
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00014s] (1, 0)
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT migration_changes.migration_id, migration_changes.version 
FROM migration_changes
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00012s] ()
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT recorder_runs.run_id AS recorder_runs_run_id, recorder_runs.start AS recorder_runs_start, recorder_runs."end" AS recorder_runs_end, recorder_runs.closed_incorrect AS recorder_runs_closed_incorrect, recorder_runs.created AS recorder_runs_created 
FROM recorder_runs 
WHERE recorder_runs."end" IS NULL
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO recorder_runs (start, "end", closed_incorrect, created) VALUES (?, ?, ?, ?) RETURNING run_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00018s] ('2025-08-03 11:09:50.142153', None, 0, '2025-08-03 11:09:50.174180')
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT recorder_runs.run_id AS recorder_runs_run_id, recorder_runs.start AS recorder_runs_start, recorder_runs."end" AS recorder_runs_end, recorder_runs.closed_incorrect AS recorder_runs_closed_incorrect, recorder_runs.created AS recorder_runs_created 
FROM recorder_runs ORDER BY recorder_runs.start ASC
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00018s] (1, 0)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT states.last_updated_ts 
FROM states ORDER BY states.last_updated_ts ASC
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00015s] (1, 0)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT migration_changes.migration_id, migration_changes.version 
FROM migration_changes
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.007166s ago] ()
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     pytest_homeassistant_custom_component.plugins:plugins.py:1567 Test recorder successfully started, database location: sqlite://
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00019s] (2705000516, 1936967080, 616907209, 3478486156, 2001541813, 2514025343)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_types.event_type_id, event_types.event_type 
FROM event_types 
WHERE event_types.event_type IN (?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00018s] ('component_loaded', 'service_registered')
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.001787s ago] (2514025343,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00015s] (2514025343, '{"domain":"recorder","service":"purge"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_types (event_type) VALUES (?) RETURNING event_type_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00015s] ('service_registered',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00027s] (None, None, None, 0, None, 1754219390.1430354, None, None, None, 1, <memory at 0x7fff69c8e200>, None, None, 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.006241s ago] (2001541813,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.004281s ago] (2001541813, '{"domain":"recorder","service":"purge_entities"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.002628s ago] (None, None, None, 0, None, 1754219390.1430671, None, None, None, 2, <memory at 0x7fff69c8e440>, None, None, 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.008479s ago] (616907209,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.006442s ago] (616907209, '{"domain":"recorder","service":"enable"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.004759s ago] (None, None, None, 0, None, 1754219390.1430795, None, None, None, 3, <memory at 0x7fff69c8e680>, None, None, 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01058s ago] (3478486156,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.008622s ago] (3478486156, '{"domain":"recorder","service":"disable"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.006987s ago] (None, None, None, 0, None, 1754219390.1431007, None, None, None, 4, <memory at 0x7fff69c8e8c0>, None, None, 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01279s ago] (1936967080,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01072s ago] (1936967080, '{"domain":"recorder","service":"get_statistics"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.009074s ago] (None, None, None, 0, None, 1754219390.1431117, None, None, None, 5, <memory at 0x7fff69c8eb00>, None, None, 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01495s ago] (2705000516,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01295s ago] (2705000516, '{"component":"recorder"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_types (event_type) VALUES (?) RETURNING event_type_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01244s ago] ('component_loaded',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01171s ago] (None, None, None, 0, None, 1754219390.1800928, None, None, None, 6, <memory at 0x7fff69c8ed40>, None, None, 2)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
----------------------------- Captured stderr call -----------------------------
INFO:homeassistant.loader:Loaded ista_calista from custom_components.ista_calista
WARNING:homeassistant.loader:We found a custom integration ista_calista which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
INFO:homeassistant.setup:Setting up ista_calista
INFO:custom_components.ista_calista:Successfully logged in for account test@example.com
INFO:custom_components.ista_calista.coordinator:Initial fetch successful. Discovered 3 device(s).
INFO:homeassistant.loader:Loaded sensor from homeassistant.components.sensor
INFO:homeassistant.setup:Setting up sensor
INFO:homeassistant.components.sensor:Setting up ista_calista.sensor
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:custom_components.ista_calista.sensor:Adding 6 new Ista Calista sensor entities.
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:homeassistant.helpers.entity_registry:Registered new sensor.ista_calista entity: sensor.living_room_energy
INFO:sqlalchemy.engine.Engine:[cached since 0.02411s ago] (2071222324,)
INFO:homeassistant.helpers.entity_registry:Registered new sensor.ista_calista entity: sensor.living_room_timestamp
INFO:homeassistant.helpers.entity_registry:Registered new sensor.ista_calista entity: sensor.bathroom_water
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02487s ago] (2071222324, '{"component":"sensor"}')
INFO:homeassistant.helpers.entity_registry:Registered new sensor.ista_calista entity: sensor.bathroom_timestamp
INFO:homeassistant.helpers.entity_registry:Registered new sensor.ista_calista entity: sensor.kitchen_water
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02477s ago] (None, None, None, 0, None, 1754219390.204153, None, None, None, 7, <memory at 0x7fff69c8f400>, None, None, 2)
INFO:homeassistant.helpers.entity_registry:Registered new sensor.ista_calista entity: sensor.kitchen_timestamp
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta 
WHERE statistics_meta.statistic_id IN (?)
INFO:sqlalchemy.engine.Engine:[generated in 0.00018s] ('ista_calista:heating_123_heating',)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta 
WHERE statistics_meta.statistic_id IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.0009846s ago] ('ista_calista:hot_water_456_hot_water',)
INFO:custom_components.ista_calista.sensor:Importing 3 new statistic(s) for ista_calista:heating_123_heating.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:custom_components.ista_calista.sensor:Importing 3 new statistic(s) for ista_calista:hot_water_456_hot_water.
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta 
WHERE statistics_meta.statistic_id IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.002345s ago] ('ista_calista:cold_water_789_water',)
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:custom_components.ista_calista.sensor:Importing 3 new statistic(s) for ista_calista:cold_water_789_water.
------------------------------ Captured log call -------------------------------
INFO     homeassistant.loader:loader.py:774 Loaded ista_calista from custom_components.ista_calista
WARNING  homeassistant.loader:loader.py:690 We found a custom integration ista_calista which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant
INFO     homeassistant.setup:setup.py:393 Setting up ista_calista
INFO     custom_components.ista_calista:__init__.py:81 Successfully logged in for account test@example.com
INFO     custom_components.ista_calista.coordinator:coordinator.py:100 Initial fetch successful. Discovered 3 device(s).
INFO     homeassistant.loader:loader.py:774 Loaded sensor from homeassistant.components.sensor
INFO     homeassistant.setup:setup.py:393 Setting up sensor
INFO     homeassistant.components.sensor:entity_platform.py:367 Setting up ista_calista.sensor
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     custom_components.ista_calista.sensor:sensor.py:135 Adding 6 new Ista Calista sensor entities.
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     homeassistant.helpers.entity_registry:entity_registry.py:1032 Registered new sensor.ista_calista entity: sensor.living_room_energy
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.02411s ago] (2071222324,)
INFO     homeassistant.helpers.entity_registry:entity_registry.py:1032 Registered new sensor.ista_calista entity: sensor.living_room_timestamp
INFO     homeassistant.helpers.entity_registry:entity_registry.py:1032 Registered new sensor.ista_calista entity: sensor.bathroom_water
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.02487s ago] (2071222324, '{"component":"sensor"}')
INFO     homeassistant.helpers.entity_registry:entity_registry.py:1032 Registered new sensor.ista_calista entity: sensor.bathroom_timestamp
INFO     homeassistant.helpers.entity_registry:entity_registry.py:1032 Registered new sensor.ista_calista entity: sensor.kitchen_water
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.02477s ago] (None, None, None, 0, None, 1754219390.204153, None, None, None, 7, <memory at 0x7fff69c8f400>, None, None, 2)
INFO     homeassistant.helpers.entity_registry:entity_registry.py:1032 Registered new sensor.ista_calista entity: sensor.kitchen_timestamp
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta 
WHERE statistics_meta.statistic_id IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00018s] ('ista_calista:heating_123_heating',)
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta 
WHERE statistics_meta.statistic_id IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.0009846s ago] ('ista_calista:hot_water_456_hot_water',)
INFO     custom_components.ista_calista.sensor:sensor.py:405 Importing 3 new statistic(s) for ista_calista:heating_123_heating.
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     custom_components.ista_calista.sensor:sensor.py:405 Importing 3 new statistic(s) for ista_calista:hot_water_456_hot_water.
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta 
WHERE statistics_meta.statistic_id IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.002345s ago] ('ista_calista:cold_water_789_water',)
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     custom_components.ista_calista.sensor:sensor.py:405 Importing 3 new statistic(s) for ista_calista:cold_water_789_water.
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_types.event_type_id, event_types.event_type 
FROM event_types 
WHERE event_types.event_type IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.03504s ago] ('device_registry_updated',)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.03657s ago] (3237574589,)
--------------------------- Captured stderr teardown ---------------------------
INFO:sqlalchemy.engine.Engine:INSERT INTO states_meta (entity_id) VALUES (?) RETURNING metadata_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00022s] ('sensor.living_room_energy',)
INFO:sqlalchemy.engine.Engine:INSERT INTO states (entity_id, state, attributes, event_id, last_changed, last_changed_ts, last_reported_ts, last_updated, last_updated_ts, old_state_id, attributes_id, context_id, context_user_id, context_parent_id, origin_idx, context_id_bin, context_user_id_bin, context_parent_id_bin, metadata_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING state_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00024s] (None, '1080.0', None, None, None, None, 1754219390.206941, None, 1754219390.2061903, None, 1, None, None, None, 0, <memory at 0x7fff69cf4640>, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.1843s ago] (421196716,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1824s ago] (421196716, '{"action":"update","entity_id":"sensor.living_room_energy","changes":{"options":{}}}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1808s ago] (None, None, None, 0, None, 1754219390.2060905, None, None, None, 10, <memory at 0x7fff69cf4940>, None, None, 4)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.1868s ago] (1222516510,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1848s ago] (1222516510, '{"action":"create","entity_id":"sensor.living_room_timestamp"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1832s ago] (None, None, None, 0, None, 1754219390.2072265, None, None, None, 11, <memory at 0x7fff69cf4d00>, None, None, 4)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT states_meta.metadata_id, states_meta.entity_id 
FROM states_meta 
WHERE states_meta.entity_id IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.04797s ago] ('sensor.living_room_timestamp',)
INFO:sqlalchemy.engine.Engine:SELECT state_attributes.attributes_id, state_attributes.shared_attrs 
FROM state_attributes 
WHERE state_attributes.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.03669s ago] (3108299739,)
INFO:sqlalchemy.engine.Engine:INSERT INTO state_attributes (hash, shared_attrs) VALUES (?, ?) RETURNING attributes_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02577s ago] (3108299739, '{"device_class":"timestamp","friendly_name":"Living Room Timestamp"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO states_meta (entity_id) VALUES (?) RETURNING metadata_id
INFO:sqlalchemy.engine.Engine:[cached since 0.009685s ago] ('sensor.living_room_timestamp',)
INFO:sqlalchemy.engine.Engine:INSERT INTO states (entity_id, state, attributes, event_id, last_changed, last_changed_ts, last_reported_ts, last_updated, last_updated_ts, old_state_id, attributes_id, context_id, context_user_id, context_parent_id, origin_idx, context_id_bin, context_user_id_bin, context_parent_id_bin, metadata_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING state_id
INFO:sqlalchemy.engine.Engine:[cached since 0.008693s ago] (None, '2024-03-01T00:00:00+00:00', None, None, None, None, None, None, 1754219390.2073226, None, 2, None, None, None, 0, <memory at 0x7fff69cf4e80>, None, None, 2)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.1925s ago] (3528058083,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1905s ago] (3528058083, '{"action":"create","device_id":"b168ac93a9a366edbdbe393a7eed592d"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1888s ago] (None, None, None, 0, None, 1754219390.2074585, None, None, None, 12, <memory at 0x7fff69cf50c0>, None, None, 3)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.1947s ago] (927012196,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1927s ago] (927012196, '{"action":"create","entity_id":"sensor.bathroom_water"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.191s ago] (None, None, None, 0, None, 1754219390.2076485, None, None, None, 13, <memory at 0x7fff69cf5300>, None, None, 4)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT states_meta.metadata_id, states_meta.entity_id 
FROM states_meta 
WHERE states_meta.entity_id IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.05576s ago] ('sensor.bathroom_water',)
INFO:sqlalchemy.engine.Engine:SELECT state_attributes.attributes_id, state_attributes.shared_attrs 
FROM state_attributes 
WHERE state_attributes.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.04446s ago] (706150344,)
INFO:sqlalchemy.engine.Engine:INSERT INTO state_attributes (hash, shared_attrs) VALUES (?, ?) RETURNING attributes_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03357s ago] (706150344, '{"state_class":"total_increasing","unit_of_measurement":"m","device_class":"water","friendly_name":"Bathroom Water"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO states_meta (entity_id) VALUES (?) RETURNING metadata_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01746s ago] ('sensor.bathroom_water',)
INFO:sqlalchemy.engine.Engine:INSERT INTO states (entity_id, state, attributes, event_id, last_changed, last_changed_ts, last_reported_ts, last_updated, last_updated_ts, old_state_id, attributes_id, context_id, context_user_id, context_parent_id, origin_idx, context_id_bin, context_user_id_bin, context_parent_id_bin, metadata_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING state_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01651s ago] (None, '58.9', None, None, None, None, 1754219390.2094376, None, 1754219390.2078078, None, 3, None, None, None, 0, <memory at 0x7fff69cf5600>, None, None, 3)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.2003s ago] (2855832096,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1983s ago] (2855832096, '{"action":"update","entity_id":"sensor.bathroom_water","changes":{"options":{}}}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1966s ago] (None, None, None, 0, None, 1754219390.2077394, None, None, None, 14, <memory at 0x7fff69cf5840>, None, None, 4)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.2024s ago] (680501251,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2004s ago] (680501251, '{"action":"create","entity_id":"sensor.bathroom_timestamp"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1987s ago] (None, None, None, 0, None, 1754219390.2098212, None, None, None, 15, <memory at 0x7fff69cf5a80>, None, None, 4)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT states_meta.metadata_id, states_meta.entity_id 
FROM states_meta 
WHERE states_meta.entity_id IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.06357s ago] ('sensor.bathroom_timestamp',)
INFO:sqlalchemy.engine.Engine:SELECT state_attributes.attributes_id, state_attributes.shared_attrs 
FROM state_attributes 
WHERE state_attributes.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.05229s ago] (1017065901,)
INFO:sqlalchemy.engine.Engine:INSERT INTO state_attributes (hash, shared_attrs) VALUES (?, ?) RETURNING attributes_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04135s ago] (1017065901, '{"device_class":"timestamp","friendly_name":"Bathroom Timestamp"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO states_meta (entity_id) VALUES (?) RETURNING metadata_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02524s ago] ('sensor.bathroom_timestamp',)
INFO:sqlalchemy.engine.Engine:INSERT INTO states (entity_id, state, attributes, event_id, last_changed, last_changed_ts, last_reported_ts, last_updated, last_updated_ts, old_state_id, attributes_id, context_id, context_user_id, context_parent_id, origin_idx, context_id_bin, context_user_id_bin, context_parent_id_bin, metadata_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING state_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02426s ago] (None, '2024-03-01T00:00:00+00:00', None, None, None, None, None, None, 1754219390.209907, None, 4, None, None, None, 0, <memory at 0x7fff69cf5d80>, None, None, 4)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.208s ago] (3624392601,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2059s ago] (3624392601, '{"action":"create","device_id":"df2460d09e0184fe1832b73611a87149"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2043s ago] (None, None, None, 0, None, 1754219390.2100246, None, None, None, 16, <memory at 0x7fff69cf5fc0>, None, None, 3)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.2101s ago] (3490941008,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2082s ago] (3490941008, '{"action":"create","entity_id":"sensor.kitchen_water"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2065s ago] (None, None, None, 0, None, 1754219390.2102134, None, None, None, 17, <memory at 0x7fff69cf6200>, None, None, 4)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT states_meta.metadata_id, states_meta.entity_id 
FROM states_meta 
WHERE states_meta.entity_id IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.07123s ago] ('sensor.kitchen_water',)
INFO:sqlalchemy.engine.Engine:SELECT state_attributes.attributes_id, state_attributes.shared_attrs 
FROM state_attributes 
WHERE state_attributes.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.05993s ago] (906086630,)
INFO:sqlalchemy.engine.Engine:INSERT INTO state_attributes (hash, shared_attrs) VALUES (?, ?) RETURNING attributes_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04898s ago] (906086630, '{"state_class":"total_increasing","unit_of_measurement":"m","device_class":"water","friendly_name":"Kitchen Water"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO states_meta (entity_id) VALUES (?) RETURNING metadata_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03289s ago] ('sensor.kitchen_water',)
INFO:sqlalchemy.engine.Engine:INSERT INTO states (entity_id, state, attributes, event_id, last_changed, last_changed_ts, last_reported_ts, last_updated, last_updated_ts, old_state_id, attributes_id, context_id, context_user_id, context_parent_id, origin_idx, context_id_bin, context_user_id_bin, context_parent_id_bin, metadata_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING state_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03189s ago] (None, '120.1', None, None, None, None, 1754219390.2114873, None, 1754219390.2103806, None, 5, None, None, None, 0, <memory at 0x7fff69cf6500>, None, None, 5)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.2156s ago] (3242506622,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2136s ago] (3242506622, '{"action":"update","entity_id":"sensor.kitchen_water","changes":{"options":{}}}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.212s ago] (None, None, None, 0, None, 1754219390.2103195, None, None, None, 18, <memory at 0x7fff69cf6740>, None, None, 4)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.2178s ago] (2512929471,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2158s ago] (2512929471, '{"action":"create","entity_id":"sensor.kitchen_timestamp"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2141s ago] (None, None, None, 0, None, 1754219390.2118976, None, None, None, 19, <memory at 0x7fff69cf6980>, None, None, 4)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT states_meta.metadata_id, states_meta.entity_id 
FROM states_meta 
WHERE states_meta.entity_id IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.07885s ago] ('sensor.kitchen_timestamp',)
INFO:sqlalchemy.engine.Engine:SELECT state_attributes.attributes_id, state_attributes.shared_attrs 
FROM state_attributes 
WHERE state_attributes.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.06754s ago] (708035423,)
INFO:sqlalchemy.engine.Engine:INSERT INTO state_attributes (hash, shared_attrs) VALUES (?, ?) RETURNING attributes_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05661s ago] (708035423, '{"device_class":"timestamp","friendly_name":"Kitchen Timestamp"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO states_meta (entity_id) VALUES (?) RETURNING metadata_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04049s ago] ('sensor.kitchen_timestamp',)
INFO:sqlalchemy.engine.Engine:INSERT INTO states (entity_id, state, attributes, event_id, last_changed, last_changed_ts, last_reported_ts, last_updated, last_updated_ts, old_state_id, attributes_id, context_id, context_user_id, context_parent_id, origin_idx, context_id_bin, context_user_id_bin, context_parent_id_bin, metadata_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING state_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0395s ago] (None, '2024-03-01T00:00:00+00:00', None, None, None, None, None, None, 1754219390.211985, None, 6, None, None, None, 0, <memory at 0x7fff69cf6c80>, None, None, 6)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.2233s ago] (1020226369,)
INFO:sqlalchemy.engine.Engine:INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2213s ago] (1020226369, '{"component":"ista_calista"}')
INFO:sqlalchemy.engine.Engine:INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2196s ago] (None, None, None, 0, None, 1754219390.2121925, None, None, None, 20, <memory at 0x7fff69cf6ec0>, None, None, 2)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta 
WHERE statistics_meta.statistic_id IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.1935s ago] ('ista_calista:heating_123_heating',)
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics_meta (statistic_id, source, unit_of_measurement, has_mean, has_sum, name, mean_type) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[generated in 0.00018s] ('ista_calista:heating_123_heating', 'ista_calista', <UnitOfEnergy.KILO_WATT_HOUR: 'kWh'>, None, 1, 'Living Room Heating', <StatisticMeanType.NONE: 0>)
INFO:sqlalchemy.engine.Engine:SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00016s] (1, 1704067200.0, 1, 0)
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[generated in 0.00019s] (None, 1754219390.4088514, 1, None, 1704067200.0, None, None, None, None, None, 1704067200.0, 1000.0, 0.0)
INFO:sqlalchemy.engine.Engine:SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.002269s ago] (1, 1706745600.0, 1, 0)
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[cached since 0.001675s ago] (None, 1754219390.4088514, 1, None, 1706745600.0, None, None, None, None, None, 1704067200.0, 1050.5, 50.5)
INFO:sqlalchemy.engine.Engine:SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.003658s ago] (1, 1709251200.0, 1, 0)
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[cached since 0.002846s ago] (None, 1754219390.4088514, 1, None, 1709251200.0, None, None, None, None, None, 1704067200.0, 1080.0, 80.0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta 
WHERE statistics_meta.statistic_id IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.2013s ago] ('ista_calista:hot_water_456_hot_water',)
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics_meta (statistic_id, source, unit_of_measurement, has_mean, has_sum, name, mean_type) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[cached since 0.007513s ago] ('ista_calista:hot_water_456_hot_water', 'ista_calista', <UnitOfVolume.CUBIC_METERS: 'm'>, None, 1, 'Bathroom Hot Water', <StatisticMeanType.NONE: 0>)
INFO:sqlalchemy.engine.Engine:SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.006836s ago] (2, 1704067200.0, 1, 0)
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[cached since 0.006225s ago] (None, 1754219390.4160728, 2, None, 1704067200.0, None, None, None, None, None, 1704067200.0, 50.0, 0.0)
INFO:sqlalchemy.engine.Engine:SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.008214s ago] (2, 1706745600.0, 1, 0)
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[cached since 0.007591s ago] (None, 1754219390.4160728, 2, None, 1706745600.0, None, None, None, None, None, 1704067200.0, 55.2, 5.200000000000003)
INFO:sqlalchemy.engine.Engine:SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.009569s ago] (2, 1709251200.0, 1, 0)
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[cached since 0.008765s ago] (None, 1754219390.4160728, 2, None, 1709251200.0, None, None, None, None, None, 1704067200.0, 58.9, 8.899999999999999)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta 
WHERE statistics_meta.statistic_id IN (?)
INFO:sqlalchemy.engine.Engine:[cached since 0.2072s ago] ('ista_calista:cold_water_789_water',)
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics_meta (statistic_id, source, unit_of_measurement, has_mean, has_sum, name, mean_type) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[cached since 0.01331s ago] ('ista_calista:cold_water_789_water', 'ista_calista', <UnitOfVolume.CUBIC_METERS: 'm'>, None, 1, 'Kitchen Water', <StatisticMeanType.NONE: 0>)
INFO:sqlalchemy.engine.Engine:SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01254s ago] (3, 1704067200.0, 1, 0)
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[cached since 0.01199s ago] (None, 1754219390.4218552, 3, None, 1704067200.0, None, None, None, None, None, 1704067200.0, 100.0, 0.0)
INFO:sqlalchemy.engine.Engine:SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01397s ago] (3, 1706745600.0, 1, 0)
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[cached since 0.0133s ago] (None, 1754219390.4218552, 3, None, 1706745600.0, None, None, None, None, None, 1704067200.0, 110.7, 10.700000000000003)
INFO:sqlalchemy.engine.Engine:SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0153s ago] (3, 1709251200.0, 1, 0)
INFO:sqlalchemy.engine.Engine:INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[cached since 0.0145s ago] (None, 1754219390.4218552, 3, None, 1709251200.0, None, None, None, None, None, 1704067200.0, 120.1, 20.099999999999994)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:UPDATE recorder_runs SET "end"=? WHERE recorder_runs.run_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00015s] ('2025-08-03 11:09:50.426353', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:homeassistant.components.recorder.pool.MutexPool:Pool recreating
INFO:custom_components.ista_calista:Successfully unloaded config entry: 01K1QSZ97S78K1G73YSTBYYQ4Q
---------------------------- Captured log teardown -----------------------------
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO states_meta (entity_id) VALUES (?) RETURNING metadata_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00022s] ('sensor.living_room_energy',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO states (entity_id, state, attributes, event_id, last_changed, last_changed_ts, last_reported_ts, last_updated, last_updated_ts, old_state_id, attributes_id, context_id, context_user_id, context_parent_id, origin_idx, context_id_bin, context_user_id_bin, context_parent_id_bin, metadata_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING state_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00024s] (None, '1080.0', None, None, None, None, 1754219390.206941, None, 1754219390.2061903, None, 1, None, None, None, 0, <memory at 0x7fff69cf4640>, None, None, 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1843s ago] (421196716,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1824s ago] (421196716, '{"action":"update","entity_id":"sensor.living_room_energy","changes":{"options":{}}}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1808s ago] (None, None, None, 0, None, 1754219390.2060905, None, None, None, 10, <memory at 0x7fff69cf4940>, None, None, 4)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1868s ago] (1222516510,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1848s ago] (1222516510, '{"action":"create","entity_id":"sensor.living_room_timestamp"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1832s ago] (None, None, None, 0, None, 1754219390.2072265, None, None, None, 11, <memory at 0x7fff69cf4d00>, None, None, 4)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT states_meta.metadata_id, states_meta.entity_id 
FROM states_meta 
WHERE states_meta.entity_id IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.04797s ago] ('sensor.living_room_timestamp',)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT state_attributes.attributes_id, state_attributes.shared_attrs 
FROM state_attributes 
WHERE state_attributes.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.03669s ago] (3108299739,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO state_attributes (hash, shared_attrs) VALUES (?, ?) RETURNING attributes_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.02577s ago] (3108299739, '{"device_class":"timestamp","friendly_name":"Living Room Timestamp"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO states_meta (entity_id) VALUES (?) RETURNING metadata_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.009685s ago] ('sensor.living_room_timestamp',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO states (entity_id, state, attributes, event_id, last_changed, last_changed_ts, last_reported_ts, last_updated, last_updated_ts, old_state_id, attributes_id, context_id, context_user_id, context_parent_id, origin_idx, context_id_bin, context_user_id_bin, context_parent_id_bin, metadata_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING state_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.008693s ago] (None, '2024-03-01T00:00:00+00:00', None, None, None, None, None, None, 1754219390.2073226, None, 2, None, None, None, 0, <memory at 0x7fff69cf4e80>, None, None, 2)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1925s ago] (3528058083,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1905s ago] (3528058083, '{"action":"create","device_id":"b168ac93a9a366edbdbe393a7eed592d"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1888s ago] (None, None, None, 0, None, 1754219390.2074585, None, None, None, 12, <memory at 0x7fff69cf50c0>, None, None, 3)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1947s ago] (927012196,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1927s ago] (927012196, '{"action":"create","entity_id":"sensor.bathroom_water"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.191s ago] (None, None, None, 0, None, 1754219390.2076485, None, None, None, 13, <memory at 0x7fff69cf5300>, None, None, 4)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT states_meta.metadata_id, states_meta.entity_id 
FROM states_meta 
WHERE states_meta.entity_id IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.05576s ago] ('sensor.bathroom_water',)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT state_attributes.attributes_id, state_attributes.shared_attrs 
FROM state_attributes 
WHERE state_attributes.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.04446s ago] (706150344,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO state_attributes (hash, shared_attrs) VALUES (?, ?) RETURNING attributes_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.03357s ago] (706150344, '{"state_class":"total_increasing","unit_of_measurement":"m","device_class":"water","friendly_name":"Bathroom Water"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO states_meta (entity_id) VALUES (?) RETURNING metadata_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01746s ago] ('sensor.bathroom_water',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO states (entity_id, state, attributes, event_id, last_changed, last_changed_ts, last_reported_ts, last_updated, last_updated_ts, old_state_id, attributes_id, context_id, context_user_id, context_parent_id, origin_idx, context_id_bin, context_user_id_bin, context_parent_id_bin, metadata_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING state_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01651s ago] (None, '58.9', None, None, None, None, 1754219390.2094376, None, 1754219390.2078078, None, 3, None, None, None, 0, <memory at 0x7fff69cf5600>, None, None, 3)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2003s ago] (2855832096,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1983s ago] (2855832096, '{"action":"update","entity_id":"sensor.bathroom_water","changes":{"options":{}}}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1966s ago] (None, None, None, 0, None, 1754219390.2077394, None, None, None, 14, <memory at 0x7fff69cf5840>, None, None, 4)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2024s ago] (680501251,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2004s ago] (680501251, '{"action":"create","entity_id":"sensor.bathroom_timestamp"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1987s ago] (None, None, None, 0, None, 1754219390.2098212, None, None, None, 15, <memory at 0x7fff69cf5a80>, None, None, 4)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT states_meta.metadata_id, states_meta.entity_id 
FROM states_meta 
WHERE states_meta.entity_id IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.06357s ago] ('sensor.bathroom_timestamp',)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT state_attributes.attributes_id, state_attributes.shared_attrs 
FROM state_attributes 
WHERE state_attributes.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.05229s ago] (1017065901,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO state_attributes (hash, shared_attrs) VALUES (?, ?) RETURNING attributes_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.04135s ago] (1017065901, '{"device_class":"timestamp","friendly_name":"Bathroom Timestamp"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO states_meta (entity_id) VALUES (?) RETURNING metadata_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.02524s ago] ('sensor.bathroom_timestamp',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO states (entity_id, state, attributes, event_id, last_changed, last_changed_ts, last_reported_ts, last_updated, last_updated_ts, old_state_id, attributes_id, context_id, context_user_id, context_parent_id, origin_idx, context_id_bin, context_user_id_bin, context_parent_id_bin, metadata_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING state_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.02426s ago] (None, '2024-03-01T00:00:00+00:00', None, None, None, None, None, None, 1754219390.209907, None, 4, None, None, None, 0, <memory at 0x7fff69cf5d80>, None, None, 4)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.208s ago] (3624392601,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2059s ago] (3624392601, '{"action":"create","device_id":"df2460d09e0184fe1832b73611a87149"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2043s ago] (None, None, None, 0, None, 1754219390.2100246, None, None, None, 16, <memory at 0x7fff69cf5fc0>, None, None, 3)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2101s ago] (3490941008,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2082s ago] (3490941008, '{"action":"create","entity_id":"sensor.kitchen_water"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2065s ago] (None, None, None, 0, None, 1754219390.2102134, None, None, None, 17, <memory at 0x7fff69cf6200>, None, None, 4)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT states_meta.metadata_id, states_meta.entity_id 
FROM states_meta 
WHERE states_meta.entity_id IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.07123s ago] ('sensor.kitchen_water',)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT state_attributes.attributes_id, state_attributes.shared_attrs 
FROM state_attributes 
WHERE state_attributes.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.05993s ago] (906086630,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO state_attributes (hash, shared_attrs) VALUES (?, ?) RETURNING attributes_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.04898s ago] (906086630, '{"state_class":"total_increasing","unit_of_measurement":"m","device_class":"water","friendly_name":"Kitchen Water"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO states_meta (entity_id) VALUES (?) RETURNING metadata_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.03289s ago] ('sensor.kitchen_water',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO states (entity_id, state, attributes, event_id, last_changed, last_changed_ts, last_reported_ts, last_updated, last_updated_ts, old_state_id, attributes_id, context_id, context_user_id, context_parent_id, origin_idx, context_id_bin, context_user_id_bin, context_parent_id_bin, metadata_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING state_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.03189s ago] (None, '120.1', None, None, None, None, 1754219390.2114873, None, 1754219390.2103806, None, 5, None, None, None, 0, <memory at 0x7fff69cf6500>, None, None, 5)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2156s ago] (3242506622,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2136s ago] (3242506622, '{"action":"update","entity_id":"sensor.kitchen_water","changes":{"options":{}}}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.212s ago] (None, None, None, 0, None, 1754219390.2103195, None, None, None, 18, <memory at 0x7fff69cf6740>, None, None, 4)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2178s ago] (2512929471,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2158s ago] (2512929471, '{"action":"create","entity_id":"sensor.kitchen_timestamp"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2141s ago] (None, None, None, 0, None, 1754219390.2118976, None, None, None, 19, <memory at 0x7fff69cf6980>, None, None, 4)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT states_meta.metadata_id, states_meta.entity_id 
FROM states_meta 
WHERE states_meta.entity_id IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.07885s ago] ('sensor.kitchen_timestamp',)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT state_attributes.attributes_id, state_attributes.shared_attrs 
FROM state_attributes 
WHERE state_attributes.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.06754s ago] (708035423,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO state_attributes (hash, shared_attrs) VALUES (?, ?) RETURNING attributes_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.05661s ago] (708035423, '{"device_class":"timestamp","friendly_name":"Kitchen Timestamp"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO states_meta (entity_id) VALUES (?) RETURNING metadata_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.04049s ago] ('sensor.kitchen_timestamp',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO states (entity_id, state, attributes, event_id, last_changed, last_changed_ts, last_reported_ts, last_updated, last_updated_ts, old_state_id, attributes_id, context_id, context_user_id, context_parent_id, origin_idx, context_id_bin, context_user_id_bin, context_parent_id_bin, metadata_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING state_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.0395s ago] (None, '2024-03-01T00:00:00+00:00', None, None, None, None, None, None, 1754219390.211985, None, 6, None, None, None, 0, <memory at 0x7fff69cf6c80>, None, None, 6)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT event_data.data_id, event_data.shared_data 
FROM event_data 
WHERE event_data.hash IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2233s ago] (1020226369,)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO event_data (hash, shared_data) VALUES (?, ?) RETURNING data_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2213s ago] (1020226369, '{"component":"ista_calista"}')
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO events (event_type, event_data, origin, origin_idx, time_fired, time_fired_ts, context_id, context_user_id, context_parent_id, data_id, context_id_bin, context_user_id_bin, context_parent_id_bin, event_type_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING event_id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2196s ago] (None, None, None, 0, None, 1754219390.2121925, None, None, None, 20, <memory at 0x7fff69cf6ec0>, None, None, 2)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta 
WHERE statistics_meta.statistic_id IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.1935s ago] ('ista_calista:heating_123_heating',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics_meta (statistic_id, source, unit_of_measurement, has_mean, has_sum, name, mean_type) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00018s] ('ista_calista:heating_123_heating', 'ista_calista', <UnitOfEnergy.KILO_WATT_HOUR: 'kWh'>, None, 1, 'Living Room Heating', <StatisticMeanType.NONE: 0>)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00016s] (1, 1704067200.0, 1, 0)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00019s] (None, 1754219390.4088514, 1, None, 1704067200.0, None, None, None, None, None, 1704067200.0, 1000.0, 0.0)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.002269s ago] (1, 1706745600.0, 1, 0)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.001675s ago] (None, 1754219390.4088514, 1, None, 1706745600.0, None, None, None, None, None, 1704067200.0, 1050.5, 50.5)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.003658s ago] (1, 1709251200.0, 1, 0)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.002846s ago] (None, 1754219390.4088514, 1, None, 1709251200.0, None, None, None, None, None, 1704067200.0, 1080.0, 80.0)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta 
WHERE statistics_meta.statistic_id IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2013s ago] ('ista_calista:hot_water_456_hot_water',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics_meta (statistic_id, source, unit_of_measurement, has_mean, has_sum, name, mean_type) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.007513s ago] ('ista_calista:hot_water_456_hot_water', 'ista_calista', <UnitOfVolume.CUBIC_METERS: 'm'>, None, 1, 'Bathroom Hot Water', <StatisticMeanType.NONE: 0>)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.006836s ago] (2, 1704067200.0, 1, 0)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.006225s ago] (None, 1754219390.4160728, 2, None, 1704067200.0, None, None, None, None, None, 1704067200.0, 50.0, 0.0)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.008214s ago] (2, 1706745600.0, 1, 0)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.007591s ago] (None, 1754219390.4160728, 2, None, 1706745600.0, None, None, None, None, None, 1704067200.0, 55.2, 5.200000000000003)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.009569s ago] (2, 1709251200.0, 1, 0)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.008765s ago] (None, 1754219390.4160728, 2, None, 1709251200.0, None, None, None, None, None, 1704067200.0, 58.9, 8.899999999999999)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics_meta.id, statistics_meta.statistic_id, statistics_meta.source, statistics_meta.unit_of_measurement, statistics_meta.has_sum, statistics_meta.name, statistics_meta.mean_type 
FROM statistics_meta 
WHERE statistics_meta.statistic_id IN (?)
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.2072s ago] ('ista_calista:cold_water_789_water',)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics_meta (statistic_id, source, unit_of_measurement, has_mean, has_sum, name, mean_type) VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01331s ago] ('ista_calista:cold_water_789_water', 'ista_calista', <UnitOfVolume.CUBIC_METERS: 'm'>, None, 1, 'Kitchen Water', <StatisticMeanType.NONE: 0>)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01254s ago] (3, 1704067200.0, 1, 0)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01199s ago] (None, 1754219390.4218552, 3, None, 1704067200.0, None, None, None, None, None, 1704067200.0, 100.0, 0.0)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.01397s ago] (3, 1706745600.0, 1, 0)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.0133s ago] (None, 1754219390.4218552, 3, None, 1706745600.0, None, None, None, None, None, 1704067200.0, 110.7, 10.700000000000003)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT statistics.id AS statistics_id 
FROM statistics 
WHERE statistics.metadata_id = ? AND statistics.start_ts = ?
 LIMIT ? OFFSET ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.0153s ago] (3, 1709251200.0, 1, 0)
INFO     sqlalchemy.engine.Engine:base.py:1842 INSERT INTO statistics (created, created_ts, metadata_id, start, start_ts, mean, mean_weight, min, max, last_reset, last_reset_ts, state, sum) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO     sqlalchemy.engine.Engine:base.py:1842 [cached since 0.0145s ago] (None, 1754219390.4218552, 3, None, 1709251200.0, None, None, None, None, None, 1704067200.0, 120.1, 20.099999999999994)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 UPDATE recorder_runs SET "end"=? WHERE recorder_runs.run_id = ?
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00015s] ('2025-08-03 11:09:50.426353', 1)
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     homeassistant.components.recorder.pool.MutexPool:impl.py:478 Pool recreating
INFO     custom_components.ista_calista:__init__.py:124 Successfully unloaded config entry: 01K1QSZ97S78K1G73YSTBYYQ4Q
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.13.5-final-0 ________________

Name                                            Stmts   Miss  Cover
-------------------------------------------------------------------
custom_components/ista_calista/__init__.py        120     54    55%
custom_components/ista_calista/config_flow.py     109      6    94%
custom_components/ista_calista/const.py            11      0   100%
custom_components/ista_calista/coordinator.py      77      2    97%
custom_components/ista_calista/sensor.py          178     18    90%
-------------------------------------------------------------------
TOTAL                                             495     80    84%
Required test coverage of 9.0% reached. Total coverage: 83.84%
=========================== short test summary info ============================
FAILED tests/test_config_flow.py::test_show_user_form_initial - AssertionErro...
FAILED tests/test_diagnostics.py::test_diagnostics - AssertionError: assert 4...
FAILED tests/test_init.py::test_remove_entry_clears_stats - AttributeError: <...
========================= 3 failed, 29 passed in 4.41s =========================
